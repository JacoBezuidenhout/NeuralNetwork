var socket = require("socket.io-client");
var port = process.argv[2];
var id = process.argv[3];
var Connection = socket.connect("127.0.0.1", {port: port});
Connection.emit("Boot", {
	id: id
});
Connection.on("Add", function(data) {
	Connection.emit("Boot", {
		id: id
	});
});
Connection.on("End", function(data) {
	process.exit(0);
});
Connection.on("Work", function(data) {
	console.log(data);
	var task = new Function("workerID",strip(data.task));
	Connection.emit("Result", {
		result: task(id),
		id: id
	});
});

var strip = function(i) {
	var l = i.split("\n");
	var l2 = [];
	for (var c = 1; c < l.length - 1; c++) {
		l2.push(l[c]);
	}
	return l2.join("\n");
};
